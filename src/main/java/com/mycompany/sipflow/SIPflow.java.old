/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.mycompany.sipflow;

/**
 *+
 * @author palmerg
 */
import com.googlecode.lanterna.gui2.BasicWindow;
import com.googlecode.lanterna.gui2.Button;
import com.googlecode.lanterna.gui2.Label;
import com.googlecode.lanterna.gui2.MultiWindowTextGUI;
import com.googlecode.lanterna.gui2.Panel;
import com.googlecode.lanterna.gui2.WindowBasedTextGUI;
import com.googlecode.lanterna.gui2.table.Table;
import com.googlecode.lanterna.screen.Screen;
import com.googlecode.lanterna.screen.TerminalScreen;
import com.googlecode.lanterna.terminal.DefaultTerminalFactory;
import com.googlecode.lanterna.terminal.Terminal;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.Reader;
import java.io.StringReader;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;
import java.util.concurrent.locks.ReentrantReadWriteLock;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class SIPflow {
	
	String testInputData ="2018-01-11 10:29:30.201425-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 437: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 421)  10.78.130.51:44481 > 10.78.130.52:5070,  length 393\r\n" + 
			"	OPTIONS sip:10.78.130.52:5070 SIP/2.0\r\n" + 
			"	To: <sip:10.78.130.52:5070>\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;branch=z9hG4bKi.uB82A72DA8E9F.r83502.gs1736794\r\n" + 
			"	Call-ID: hb@10.78.130.52.gs1736794.s323767.mi145.lt1515684566.ct1515684570.d4.2.i3.MM.0.MEQok\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%52+5070!.gs1736794.glt1515684568.r83502\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.201553-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 437: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 421)  10.78.130.51:44481 > 10.78.130.53:5070,  length 393\r\n" + 
			"	OPTIONS sip:10.78.130.53:5070 SIP/2.0\r\n" + 
			"	To: <sip:10.78.130.53:5070>\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;branch=z9hG4bKi.uB82A72DA8E9F.r66097.gs1736795\r\n" + 
			"	Call-ID: hb@10.78.130.53.gs1736795.s323724.mi128.lt1515684566.ct1515684570.d4.2.i3.MM.1.MEQok\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%53+5070!.gs1736795.glt1515684570.r66097\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.201558-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 437: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 421)  10.78.130.51:44481 > 10.78.130.53:5070,  length 393\r\n" + 
			"	OPTIONS sip:10.78.130.53:5070 SIP/2.0\r\n" + 
			"	To: <sip:10.78.130.53:5070>\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;branch=z9hG4bKi.uB82A72DA8E9F.r66097.gs1736795\r\n" + 
			"	Call-ID: hb@10.78.130.53.gs1736795.s323724.mi128.lt1515684566.ct1515684570.d4.2.i3.MM.1.MEQok\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%53+5070!.gs1736795.glt1515684570.r66097\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.202227-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 609: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 593)  10.78.130.52:5070 > 10.78.130.51:44481,  length 565\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: hb@10.78.130.52.gs1736794.s323767.mi145.lt1515684566.ct1515684570.d4.2.i3.MM.0.MEQok\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%52+5070!.gs1736794.glt1515684568.r83502\r\n" + 
			"	To: <sip:10.78.130.52:5070>;tag=10.78.130.525069+1+22420003+bce85eca\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;received=10.78.130.51;branch=z9hG4bKi.uB82A72DA8E9F.r83502.gs1736794\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Accept-Encoding: identity\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.202227-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 609: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 593)  10.78.130.52:5070 > 10.78.130.51:44481,  length 565\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: hb@10.78.130.52.gs1736794.s323767.mi145.lt1515684566.ct1515684570.d4.2.i3.MM.0.MEQok\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%52+5070!.gs1736794.glt1515684568.r83502\r\n" + 
			"	To: <sip:10.78.130.52:5070>;tag=10.78.130.525069+1+22420003+bce85eca\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;received=10.78.130.51;branch=z9hG4bKi.uB82A72DA8E9F.r83502.gs1736794\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Accept-Encoding: identity\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.202244-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 609: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 593)  10.78.130.53:5070 > 10.78.130.51:44481,  length 565\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: hb@10.78.130.53.gs1736795.s323724.mi128.lt1515684566.ct1515684570.d4.2.i3.MM.1.MEQok\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%53+5070!.gs1736795.glt1515684570.r66097\r\n" + 
			"	To: <sip:10.78.130.53:5070>;tag=10.78.130.535069+1+253c0002+8ad88cb3\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;received=10.78.130.51;branch=z9hG4bKi.uB82A72DA8E9F.r66097.gs1736795\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Accept-Encoding: identity\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.202244-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 609: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 593)  10.78.130.53:5070 > 10.78.130.51:44481,  length 565\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: hb@10.78.130.53.gs1736795.s323724.mi128.lt1515684566.ct1515684570.d4.2.i3.MM.1.MEQok\r\n" + 
			"	CSeq: 1 OPTIONS\r\n" + 
			"	From: <sip:10.78.130.100:44481>;tag=a!10%78%130%53+5070!.gs1736795.glt1515684570.r66097\r\n" + 
			"	To: <sip:10.78.130.53:5070>;tag=10.78.130.535069+1+253c0002+8ad88cb3\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:44481;received=10.78.130.51;branch=z9hG4bKi.uB82A72DA8E9F.r66097.gs1736795\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Accept-Encoding: identity\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.213047-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1516: (tos 0x68, ttl 59, id 26817, offset 0, flags [0x2000], proto UDP (17), length 1500)  10.78.81.162:5060 > 10.78.130.100:5060,  length 1472\r\n" + 
			"	INVITE sip:7334@10.78.130.100:5060 SIP/2.0\r\n" + 
			"	From: \"Prabu Soundararajan\"<sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	Supported: timer,replaces,from-change,histinfo,answermode,eventlist,recipient-list-subscribe,x-ipc-events\r\n" + 
			"	History-Info: <sip:7334@10.78.130.100:5060>; index=1\r\n" + 
			"	X-IPC-State: hfm=no;micmute=no\r\n" + 
			"	P-Asserted-Identity: \"Prabu Soundararajan\"<sip:7334@10.78.130.100>\r\n" + 
			"	Privacy: none\r\n" + 
			"	Recv-Info: x-ipc-events\r\n" + 
			"	X-IPC-Call: type=resource;usage=1\r\n" + 
			"	X-IPC-CallParty: device=handset;channel=right\r\n" + 
			"	X-IPC-Privacy: off\r\n" + 
			"	X-IPC-Talkback: on\r\n" + 
			"	X-IPC-Recording: on\r\n" + 
			"	X-IPC-MuteOption: no\r\n" + 
			"	X-IPC-Button: num=5\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Contact: <sip:psoundararajan@10.78.81.162:5060>\r\n" + 
			"	Session-Expires: 1800\r\n" + 
			"	Min-SE: 90\r\n" + 
			"	Allow: INVITE,ACK,CANCEL,BYE,REFER,OPTIONS,NOTIFY,SUBSCRIBE,PRACK,UPDATE,REGISTER,PUBLISH,INFO\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Content-Length: 354\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=IPC 911338 911338 IN IP4 10.78.81.162\r\n" + 
			"	s=IPC\r\n" + 
			"	c=IN IP4 10.78.81.162\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 16462 RTP/AVP 0 8 18 101\r\n" + 
			"	a=rtpmap:0 PCMU/8000/1\r\n" + 
			"	a=rtpmap:8 PCMA/8000/1\r\n" + 
			"	a=rtpmap:18 G729/8000/1\r\n" + 
			"	a=fmtp:18 annexb=yes\r\n" + 
			"	a=rtpmap:101 telephone-event/8000/1\r\n" + 
			"	a=fmtp:101 0-15,77,84\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtcp-xr:stat-summary=loss,dup,jitt,TTL,HL voip-metri\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.213047-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1516: (tos 0x68, ttl 59, id 26817, offset 0, flags [0x2000], proto UDP (17), length 1500)  10.78.81.162:5060 > 10.78.130.100:5060,  length 1472\r\n" + 
			"	INVITE sip:7334@10.78.130.100:5060 SIP/2.0\r\n" + 
			"	From: \"Prabu Soundararajan\"<sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	Supported: timer,replaces,from-change,histinfo,answermode,eventlist,recipient-list-subscribe,x-ipc-events\r\n" + 
			"	History-Info: <sip:7334@10.78.130.100:5060>; index=1\r\n" + 
			"	X-IPC-State: hfm=no;micmute=no\r\n" + 
			"	P-Asserted-Identity: \"Prabu Soundararajan\"<sip:7334@10.78.130.100>\r\n" + 
			"	Privacy: none\r\n" + 
			"	Recv-Info: x-ipc-events\r\n" + 
			"	X-IPC-Call: type=resource;usage=1\r\n" + 
			"	X-IPC-CallParty: device=handset;channel=right\r\n" + 
			"	X-IPC-Privacy: off\r\n" + 
			"	X-IPC-Talkback: on\r\n" + 
			"	X-IPC-Recording: on\r\n" + 
			"	X-IPC-MuteOption: no\r\n" + 
			"	X-IPC-Button: num=5\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Contact: <sip:psoundararajan@10.78.81.162:5060>\r\n" + 
			"	Session-Expires: 1800\r\n" + 
			"	Min-SE: 90\r\n" + 
			"	Allow: INVITE,ACK,CANCEL,BYE,REFER,OPTIONS,NOTIFY,SUBSCRIBE,PRACK,UPDATE,REGISTER,PUBLISH,INFO\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Content-Length: 354\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=IPC 911338 911338 IN IP4 10.78.81.162\r\n" + 
			"	s=IPC\r\n" + 
			"	c=IN IP4 10.78.81.162\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 16462 RTP/AVP 0 8 18 101\r\n" + 
			"	a=rtpmap:0 PCMU/8000/1\r\n" + 
			"	a=rtpmap:8 PCMA/8000/1\r\n" + 
			"	a=rtpmap:18 G729/8000/1\r\n" + 
			"	a=fmtp:18 annexb=yes\r\n" + 
			"	a=rtpmap:101 telephone-event/8000/1\r\n" + 
			"	a=fmtp:101 0-15,77,84\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtcp-xr:stat-summary=loss,dup,jitt,TTL,HL voip-metri\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.213212-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1656: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1640)  10.78.130.100:5060 > 10.78.130.100:5059,  length 1612\r\n" + 
			"	INVITE sip:7334@10.78.130.100:5059 SIP/2.0\r\n" + 
			"	Record-Route: <sip:10.78.130.100;lr>\r\n" + 
			"	From: \"Prabu Soundararajan\"<sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	Supported: timer,replaces,from-change,histinfo,answermode,eventlist,recipient-list-subscribe,x-ipc-events\r\n" + 
			"	History-Info: <sip:7334@10.78.130.100:5060>; index=1\r\n" + 
			"	X-IPC-State: hfm=no;micmute=no\r\n" + 
			"	P-Asserted-Identity: \"Prabu Soundararajan\"<sip:7334@10.78.130.100>\r\n" + 
			"	Privacy: none\r\n" + 
			"	Recv-Info: x-ipc-events\r\n" + 
			"	X-IPC-Call: type=resource;usage=1\r\n" + 
			"	X-IPC-CallParty: device=handset;channel=right\r\n" + 
			"	X-IPC-Privacy: off\r\n" + 
			"	X-IPC-Talkback: on\r\n" + 
			"	X-IPC-Recording: on\r\n" + 
			"	X-IPC-MuteOption: no\r\n" + 
			"	X-IPC-Button: num=5\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Contact: <sip:psoundararajan@10.78.81.162:5060>\r\n" + 
			"	Session-Expires: 1800\r\n" + 
			"	Min-SE: 90\r\n" + 
			"	Allow: INVITE,ACK,CANCEL,BYE,REFER,OPTIONS,NOTIFY,SUBSCRIBE,PRACK,UPDATE,REGISTER,PUBLISH,INFO\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Content-Length: 354\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=IPC 911338 911338 IN IP4 10.78.81.162\r\n" + 
			"	s=IPC\r\n" + 
			"	c=IN IP4 10.78.81.162\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 16462 RTP/AVP 0 8 18 101\r\n" + 
			"	a=rtpmap:0 PCMU/8000/1\r\n" + 
			"	a=rtpmap:8 PCMA/8000/1\r\n" + 
			"	a=rtpmap:18 G729/8000/1\r\n" + 
			"	a=fmtp:18 annexb=yes\r\n" + 
			"	a=rtpmap:101 telephone-event/8000/1\r\n" + 
			"	a=fmtp:101 0-15,77,84\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtcp-xr:stat-summary=loss,dup,jitt,TTL,HL voip-metrics\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.213700-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 470: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 454)  10.78.130.100:60581 > 10.78.130.100:5060,  length 426\r\n" + 
			"	SIP/2.0 100 Trying\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	From: \"Prabu Soundararajan\" <sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.213761-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 384: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 368)  10.78.130.100:5060 > 10.78.81.162:5060,  length 340\r\n" + 
			"	SIP/2.0 100 Trying\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	From: \"Prabu Soundararajan\" <sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.213766-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 384: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 368)  10.78.130.100:5060 > 10.78.81.162:5060,  length 340\r\n" + 
			"	SIP/2.0 100 Trying\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	From: \"Prabu Soundararajan\" <sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.270046-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1287: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1271)  10.78.130.100:60402 > 10.78.130.100:5060,  length 1243\r\n" + 
			"	INVITE sip:msml@10.78.130.53:5070;collocate_method=mandatory;collocate_conf=Core7;transport=tcp SIP/2.0\r\n" + 
			"	To: sip:7334@10.78.130.53\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Min-SE: 180\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Allow: INVITE, ACK, CANCEL, BYE, UPDATE, INFO, REFER, OPTIONS, REGISTER, PUBLISH\r\n" + 
			"	Privacy: none\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	Contact: <sip:wlssuser@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-11ggl0wrwvdgx>\r\n" + 
			"	Session-Expires: 1800;refresher=uac\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 354\r\n" + 
			"	Route: <sip:7334@10.78.130.100:5060;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback, timer\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=IPC 911338 911338 IN IP4 10.78.81.162\r\n" + 
			"	s=IPC\r\n" + 
			"	c=IN IP4 10.78.81.162\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 16462 RTP/AVP 0 8 18 101\r\n" + 
			"	a=rtpmap:0 PCMU/8000/1\r\n" + 
			"	a=rtpmap:8 PCMA/8000/1\r\n" + 
			"	a=rtpmap:18 G729/8000/1\r\n" + 
			"	a=fmtp:18 annexb=yes\r\n" + 
			"	a=rtpmap:101 telephone-event/8000/1\r\n" + 
			"	a=fmtp:101 0-15,77,84\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtcp-xr:stat-summary=loss,dup,jitt,TTL,HL voip-metrics\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.270281-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1456: (tos 0x68, ttl 64, id 1079, offset 0, flags [0x4000], proto TCP (6), length 1440)  10.78.130.51:47841 > 10.78.130.53:5070: Flags:[0x18], chsum 0x1e97, seq 3308233496:3308234884, ack 2757440672, win 501, urp 0 length 1388 \r\n" + 
			"	INVITE sip:msml@10.78.130.53:5070;collocate_method=mandatory;collocate_conf=Core7;transport=tcp SIP/2.0\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	To: sip:7334@10.78.130.53\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Min-SE: 180\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Allow: INVITE, ACK, CANCEL, BYE, UPDATE, INFO, REFER, OPTIONS, REGISTER, PUBLISH\r\n" + 
			"	Privacy: none\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	Contact: <sip:wlssuser@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-11ggl0wrwvdgx>\r\n" + 
			"	Session-Expires: 1800;refresher=uac\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 354\r\n" + 
			"	Supported: X-cisco-srtp-fallback, timer\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=IPC 911338 911338 IN IP4 10.78.81.162\r\n" + 
			"	s=IPC\r\n" + 
			"	c=IN IP4 10.78.81.162\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 16462 RTP/AVP 0 8 18 101\r\n" + 
			"	a=rtpmap:0 PCMU/8000/1\r\n" + 
			"	a=rtpmap:8 PCMA/8000/1\r\n" + 
			"	a=rtpmap:18 G729/8000/1\r\n" + 
			"	a=fmtp:18 annexb=yes\r\n" + 
			"	a=rtpmap:101 telephone-event/8000/1\r\n" + 
			"	a=fmtp:101 0-15,77,84\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtcp-xr:stat-summary=loss,dup,jitt,TTL,HL voip-metrics\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.270286-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1456: (tos 0x68, ttl 64, id 1079, offset 0, flags [0x4000], proto TCP (6), length 1440)  10.78.130.51:47841 > 10.78.130.53:5070: Flags:[0x18], chsum 0x1e97, seq 3308233496:3308234884, ack 2757440672, win 501, urp 0 length 1388 \r\n" + 
			"	INVITE sip:msml@10.78.130.53:5070;collocate_method=mandatory;collocate_conf=Core7;transport=tcp SIP/2.0\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	To: sip:7334@10.78.130.53\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Min-SE: 180\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Allow: INVITE, ACK, CANCEL, BYE, UPDATE, INFO, REFER, OPTIONS, REGISTER, PUBLISH\r\n" + 
			"	Privacy: none\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	Contact: <sip:wlssuser@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-11ggl0wrwvdgx>\r\n" + 
			"	Session-Expires: 1800;refresher=uac\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 354\r\n" + 
			"	Supported: X-cisco-srtp-fallback, timer\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=IPC 911338 911338 IN IP4 10.78.81.162\r\n" + 
			"	s=IPC\r\n" + 
			"	c=IN IP4 10.78.81.162\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 16462 RTP/AVP 0 8 18 101\r\n" + 
			"	a=rtpmap:0 PCMU/8000/1\r\n" + 
			"	a=rtpmap:8 PCMA/8000/1\r\n" + 
			"	a=rtpmap:18 G729/8000/1\r\n" + 
			"	a=fmtp:18 annexb=yes\r\n" + 
			"	a=rtpmap:101 telephone-event/8000/1\r\n" + 
			"	a=fmtp:101 0-15,77,84\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtcp-xr:stat-summary=loss,dup,jitt,TTL,HL voip-metrics\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.270942-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 732: (tos 0x68, ttl 64, id 12959, offset 0, flags [0x4000], proto TCP (6), length 716)  10.78.130.53:5070 > 10.78.130.51:47841: Flags:[0x18], chsum 0x1212, seq 2757440672:2757441336, ack 3308234884, win 327, urp 0 length 664 \r\n" + 
			"	SIP/2.0 100 Trying\r\n" + 
			"	Record-Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;received=10.78.130.51;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.270942-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 732: (tos 0x68, ttl 64, id 12959, offset 0, flags [0x4000], proto TCP (6), length 716)  10.78.130.53:5070 > 10.78.130.51:47841: Flags:[0x18], chsum 0x1212, seq 2757440672:2757441336, ack 3308234884, win 327, urp 0 length 664 \r\n" + 
			"	SIP/2.0 100 Trying\r\n" + 
			"	Record-Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;received=10.78.130.51;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.271086-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 602: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 586)  10.78.130.100:5060 > 10.78.130.100:5059,  length 558\r\n" + 
			"	SIP/2.0 100 Trying\r\n" + 
			"	Record-Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.272019-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1287: (tos 0x68, ttl 64, id 12960, offset 0, flags [0x4000], proto TCP (6), length 1271)  10.78.130.53:5070 > 10.78.130.51:47841: Flags:[0x18], chsum 0x5a6e, seq 2757441336:2757442555, ack 3308234884, win 327, urp 0 length 1219 \r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;received=10.78.130.51;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Require: timer\r\n" + 
			"	Session-Expires: 1800;refresher=uac\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Record-Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Accept: application/sdp, text/*, application/msml+xml, application/moml+xml\r\n" + 
			"	Content-Length: 240\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Contact: <sip:msml@10.78.130.53:5069;transport=TCP>\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=- 35069 35069 IN IP4 10.78.130.53\r\n" + 
			"	s=media server session\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 40514 RTP/AVP 0 101\r\n" + 
			"	c=IN IP4 10.78.130.53\r\n" + 
			"	a=rtpmap:0 PCMU/8000\r\n" + 
			"	a=rtcp-xr\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtpmap:101 telephone-event/8000\r\n" + 
			"	a=fmtp:101 0-15,32,36\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.272019-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1287: (tos 0x68, ttl 64, id 12960, offset 0, flags [0x4000], proto TCP (6), length 1271)  10.78.130.53:5070 > 10.78.130.51:47841: Flags:[0x18], chsum 0x5a6e, seq 2757441336:2757442555, ack 3308234884, win 327, urp 0 length 1219 \r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;received=10.78.130.51;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Require: timer\r\n" + 
			"	Session-Expires: 1800;refresher=uac\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Record-Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Accept: application/sdp, text/*, application/msml+xml, application/moml+xml\r\n" + 
			"	Content-Length: 240\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Contact: <sip:msml@10.78.130.53:5069;transport=TCP>\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=- 35069 35069 IN IP4 10.78.130.53\r\n" + 
			"	s=media server session\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 40514 RTP/AVP 0 101\r\n" + 
			"	c=IN IP4 10.78.130.53\r\n" + 
			"	a=rtpmap:0 PCMU/8000\r\n" + 
			"	a=rtcp-xr\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtpmap:101 telephone-event/8000\r\n" + 
			"	a=fmtp:101 0-15,32,36\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.272103-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1157: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1141)  10.78.130.100:5060 > 10.78.130.100:5059,  length 1113\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK6761bb70f433a7a47c55db322f76d961;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Require: timer\r\n" + 
			"	Session-Expires: 1800;refresher=uac\r\n" + 
			"	Allow: INVITE, ACK, BYE, OPTIONS, CANCEL, INFO, PRACK, UPDATE\r\n" + 
			"	Record-Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Record-Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Accept: application/sdp, text/*, application/msml+xml, application/moml+xml\r\n" + 
			"	Content-Length: 240\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	Contact: <sip:msml@10.78.130.53:5069;transport=TCP>\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=- 35069 35069 IN IP4 10.78.130.53\r\n" + 
			"	s=media server session\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 40514 RTP/AVP 0 101\r\n" + 
			"	c=IN IP4 10.78.130.53\r\n" + 
			"	a=rtpmap:0 PCMU/8000\r\n" + 
			"	a=rtcp-xr\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtpmap:101 telephone-event/8000\r\n" + 
			"	a=fmtp:101 0-15,32,36\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.290125-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 714: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 698)  10.78.130.100:47858 > 10.78.130.100:5060,  length 670\r\n" + 
			"	ACK sip:msml@10.78.130.53:5069;transport=TCP SIP/2.0\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK63ff0af6145fc41fd4a0e657d453c625;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	CSeq: 1 ACK\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.290447-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 734: (tos 0x68, ttl 64, id 1082, offset 0, flags [0x4000], proto TCP (6), length 718)  10.78.130.51:47841 > 10.78.130.53:5070: Flags:[0x18], chsum 0x1bc5, seq 3308234884:3308235550, ack 2757442555, win 501, urp 0 length 666 \r\n" + 
			"	ACK sip:msml@10.78.130.53:5069;transport=TCP SIP/2.0\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;branch=z9hG4bK63ff0af6145fc41fd4a0e657d453c625\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK63ff0af6145fc41fd4a0e657d453c625;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	CSeq: 1 ACK\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.290454-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 734: (tos 0x68, ttl 64, id 1082, offset 0, flags [0x4000], proto TCP (6), length 718)  10.78.130.51:47841 > 10.78.130.53:5070: Flags:[0x18], chsum 0x1bc5, seq 3308234884:3308235550, ack 2757442555, win 501, urp 0 length 666 \r\n" + 
			"	ACK sip:msml@10.78.130.53:5069;transport=TCP SIP/2.0\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;branch=z9hG4bK63ff0af6145fc41fd4a0e657d453c625\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK63ff0af6145fc41fd4a0e657d453c625;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	CSeq: 1 ACK\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.294676-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1572: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1556)  10.78.130.100:60581 > 10.78.130.100:5060,  length 1528\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>;tag=4a992754\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Allow: INVITE, ACK, CANCEL, BYE, UPDATE, INFO, REFER, OPTIONS, REGISTER, PUBLISH\r\n" + 
			"	Record-Route: <sip:10.78.130.100;lr>\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	X-IPC-MM: isFocus=on\r\n" + 
			"	X-IPC-State: hfm=no;micmute=no\r\n" + 
			"	X-IPC-CallParty: device=handset;channel=right\r\n" + 
			"	From: \"Prabu Soundararajan\" <sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	Contact: <sip:app-rrs4jz624xn9@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-rrs4jz624xn9>;isfocus\r\n" + 
			"	X-IPC-Recording: on\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Recv-Info: x-ipc-events\r\n" + 
			"	X-IPC-Connection-ID: Conn_208439_10.78.130.100_1515684570218\r\n" + 
			"	X-IPC-MuteOption: no\r\n" + 
			"	X-IPC-Talkback: on\r\n" + 
			"	Privacy: none\r\n" + 
			"	X-IPC-Call-ID: Call_176274_10.78.130.100_1515684510818\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	Session-Expires: 1800;refresher=uas\r\n" + 
			"	X-IPC-Call: type=resource;usage=1\r\n" + 
			"	X-IPC-Privacy: off\r\n" + 
			"	X-IPC-Button: num=5\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 252\r\n" + 
			"	Require: timer\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=- 35069 35069 IN IP4 10.78.130.53\r\n" + 
			"	s=media server session :Negotiated\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 40514 RTP/AVP 0 101\r\n" + 
			"	c=IN IP4 10.78.130.53\r\n" + 
			"	a=rtpmap:0 PCMU/8000\r\n" + 
			"	a=rtcp-xr\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtpmap:101 telephone-event/8000\r\n" + 
			"	a=fmtp:101 0-15,32,36\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.294764-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1486: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1470)  10.78.130.100:5060 > 10.78.81.162:5060,  length 1442\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>;tag=4a992754\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Allow: INVITE, ACK, CANCEL, BYE, UPDATE, INFO, REFER, OPTIONS, REGISTER, PUBLISH\r\n" + 
			"	Record-Route: <sip:10.78.130.100;lr>\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	X-IPC-MM: isFocus=on\r\n" + 
			"	X-IPC-State: hfm=no;micmute=no\r\n" + 
			"	X-IPC-CallParty: device=handset;channel=right\r\n" + 
			"	From: \"Prabu Soundararajan\" <sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	Contact: <sip:app-rrs4jz624xn9@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-rrs4jz624xn9>;isfocus\r\n" + 
			"	X-IPC-Recording: on\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Recv-Info: x-ipc-events\r\n" + 
			"	X-IPC-Connection-ID: Conn_208439_10.78.130.100_1515684570218\r\n" + 
			"	X-IPC-MuteOption: no\r\n" + 
			"	X-IPC-Talkback: on\r\n" + 
			"	Privacy: none\r\n" + 
			"	X-IPC-Call-ID: Call_176274_10.78.130.100_1515684510818\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	Session-Expires: 1800;refresher=uas\r\n" + 
			"	X-IPC-Call: type=resource;usage=1\r\n" + 
			"	X-IPC-Privacy: off\r\n" + 
			"	X-IPC-Button: num=5\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 252\r\n" + 
			"	Require: timer\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=- 35069 35069 IN IP4 10.78.130.53\r\n" + 
			"	s=media server session :Negotiated\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 40514 RTP/AVP 0 101\r\n" + 
			"	c=IN IP4 10.78.130.53\r\n" + 
			"	a=rtpmap:0 PCMU/8000\r\n" + 
			"	a=rtcp-xr\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtpmap:101 telephone-event/8000\r\n" + 
			"	a=fmtp:101 0-15,32,36\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.294771-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1486: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1470)  10.78.130.100:5060 > 10.78.81.162:5060,  length 1442\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Content-Type: application/sdp\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>;tag=4a992754\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f7b1-6c6a8d46-38c22e30\r\n" + 
			"	Allow: INVITE, ACK, CANCEL, BYE, UPDATE, INFO, REFER, OPTIONS, REGISTER, PUBLISH\r\n" + 
			"	Record-Route: <sip:10.78.130.100;lr>\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	X-IPC-MM: isFocus=on\r\n" + 
			"	X-IPC-State: hfm=no;micmute=no\r\n" + 
			"	X-IPC-CallParty: device=handset;channel=right\r\n" + 
			"	From: \"Prabu Soundararajan\" <sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	Contact: <sip:app-rrs4jz624xn9@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-rrs4jz624xn9>;isfocus\r\n" + 
			"	X-IPC-Recording: on\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Recv-Info: x-ipc-events\r\n" + 
			"	X-IPC-Connection-ID: Conn_208439_10.78.130.100_1515684570218\r\n" + 
			"	X-IPC-MuteOption: no\r\n" + 
			"	X-IPC-Talkback: on\r\n" + 
			"	Privacy: none\r\n" + 
			"	X-IPC-Call-ID: Call_176274_10.78.130.100_1515684510818\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	Session-Expires: 1800;refresher=uas\r\n" + 
			"	X-IPC-Call: type=resource;usage=1\r\n" + 
			"	X-IPC-Privacy: off\r\n" + 
			"	X-IPC-Button: num=5\r\n" + 
			"	CSeq: 1 INVITE\r\n" + 
			"	Content-Length: 252\r\n" + 
			"	Require: timer\r\n" + 
			"	\r\n" + 
			"	v=0\r\n" + 
			"	o=- 35069 35069 IN IP4 10.78.130.53\r\n" + 
			"	s=media server session :Negotiated\r\n" + 
			"	t=0 0\r\n" + 
			"	m=audio 40514 RTP/AVP 0 101\r\n" + 
			"	c=IN IP4 10.78.130.53\r\n" + 
			"	a=rtpmap:0 PCMU/8000\r\n" + 
			"	a=rtcp-xr\r\n" + 
			"	a=ptime:10\r\n" + 
			"	a=rtpmap:101 telephone-event/8000\r\n" + 
			"	a=fmtp:101 0-15,32,36\r\n" + 
			"	a=sendrecv\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.298850-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1791: (tos 0x0, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 1775)  10.78.130.100:47858 > 10.78.130.100:5060,  length 1747\r\n" + 
			"	INFO sip:msml@10.78.130.53:5069;transport=TCP SIP/2.0\r\n" + 
			"	Content-Type: application/msml+xml\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK577e70175bc10246b47289d55455f9e1;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	CSeq: 2 INFO\r\n" + 
			"	Content-Length: 1036\r\n" + 
			"	Route: <sip:10.78.130.100;r2=on;lr>\r\n" + 
			"	Route: <sip:10.78.130.100;transport=tcp;r2=on;lr>\r\n" + 
			"	Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	\r\n" + 
			"	<?xml version=\"1.0\" encoding=\"US-ASCII\" standalone=\"yes\"?>\r\n" + 
			"	<!--from:10.78.81.162:16462 to:10.78.130.53:40514 party=ms5971:mConn_208439_10.78.130.100_1515684570218-->\r\n" + 
			"	<msml version=\"1.1\">\r\n" + 
			"	<dialogstart target=\"conn:10.78.130.535069+1+26c40002+21d63b9f\" type=\"application/moml+xml\" mark=\"71\">\r\n" + 
			"	<dtmf cleardb=\"false\" iterate=\"forever\">\r\n" + 
			"	<pattern digits=\"length=1\" format=\"moml+digits\">\r\n" + 
			"	<send event=\"app.DtmfDigitReceived\" target=\"source\" namelist=\"dtmf.digits\"/>\r\n" + 
			"	</pattern>\r\n" + 
			"	</dtmf>\r\n" + 
			"	<exit namelist=\"dtmf.end\"/>\r\n" + 
			"	</dialogstart>\r\n" + 
			"	<configureconnection id=\"conn:10.78.130.535069+1+26c40002+21d63b9f\">\r\n" + 
			"	<pps media=\"audio\" namelist=\"packet.*\" enabled=\"true\"/>\r\n" + 
			"	</configureconnection>\r\n" + 
			"	<join id1=\"conf:tribMix1497x3ms1c7b1495t1515684510894\" id2=\"conn:10.78.130.535069+1+26c40002+21d63b9f\" mark=\"42\">\r\n" + 
			"	<stream media=\"audio\" dir=\"from-id1\">\r\n" + 
			"	<tpc call-type=\"NH\" ptt-state=\"null\" use-rtp-ext=\"enabled\"/>\r\n" + 
			"	</stream>\r\n" + 
			"	<stream media=\"audio\" dir=\"to-id1\">\r\n" + 
			"	<tpc call-type=\"NH\" ptt-state=\"null\" use-rtp-ext=\"enabled\"/>\r\n" + 
			"	</stream>\r\n" + 
			"	</join>\r\n" + 
			"	</msml>\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.299026-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1516: (tos 0x68, ttl 64, id 1083, offset 0, flags [0x4000], proto TCP (6), length 1500)  10.78.130.51:47841 > 10.78.130.53:5070: Flags:[0x10], chsum 0x1ed3, seq 3308235550:3308236998, ack 2757442555, win 501, urp 0 length 1448 \r\n" + 
			"	INFO sip:msml@10.78.130.53:5069;transport=TCP SIP/2.0\r\n" + 
			"	Content-Type: application/msml+xml\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;branch=z9hG4bK577e70175bc10246b47289d55455f9e1\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK577e70175bc10246b47289d55455f9e1;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	CSeq: 2 INFO\r\n" + 
			"	Content-Length: 1036\r\n" + 
			"	Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	\r\n" + 
			"	<?xml version=\"1.0\" encoding=\"US-ASCII\" standalone=\"yes\"?>\r\n" + 
			"	<!--from:10.78.81.162:16462 to:10.78.130.53:40514 party=ms5971:mConn_208439_10.78.130.100_1515684570218-->\r\n" + 
			"	<msml version=\"1.1\">\r\n" + 
			"	<dialogstart target=\"conn:10.78.130.535069+1+26c40002+21d63b9f\" type=\"application/moml+xml\" mark=\"71\">\r\n" + 
			"	<dtmf cleardb=\"false\" iterate=\"forever\">\r\n" + 
			"	<pattern digits=\"length=1\" format=\"moml+digits\">\r\n" + 
			"	<send event=\"app.DtmfDigitReceived\" target=\"source\" namelist=\"dtmf.digits\"/>\r\n" + 
			"	</pattern>\r\n" + 
			"	</dtmf>\r\n" + 
			"	<exit namelist=\"dtmf.end\"/>\r\n" + 
			"	</dialogstart>\r\n" + 
			"	<configureconnection id=\"conn:10.78.130.535069+1+26c40002+21d63b9f\">\r\n" + 
			"	<pps media=\"audio\" namelist=\"packet.*\" enabled=\"true\"/>\r\n" + 
			"	</configureconnection>\r\n" + 
			"	<join id1=\"conf:tribMix1497x3ms1c7b1495t1515684510894\" id2=\"\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.299031-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 1516: (tos 0x68, ttl 64, id 1083, offset 0, flags [0x4000], proto TCP (6), length 1500)  10.78.130.51:47841 > 10.78.130.53:5070: Flags:[0x10], chsum 0x1ed3, seq 3308235550:3308236998, ack 2757442555, win 501, urp 0 length 1448 \r\n" + 
			"	INFO sip:msml@10.78.130.53:5069;transport=TCP SIP/2.0\r\n" + 
			"	Content-Type: application/msml+xml\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;branch=z9hG4bK577e70175bc10246b47289d55455f9e1\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK577e70175bc10246b47289d55455f9e1;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	CSeq: 2 INFO\r\n" + 
			"	Content-Length: 1036\r\n" + 
			"	Route: <sip:10.78.130.53:5070;transport=tcp;lr>\r\n" + 
			"	Supported: X-cisco-srtp-fallback\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	X-IPC-Connection-ID: ms5971:mConn_208439_10.78.130.100_1515684570218\r\n" + 
			"	Max-Forwards: 69\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	\r\n" + 
			"	<?xml version=\"1.0\" encoding=\"US-ASCII\" standalone=\"yes\"?>\r\n" + 
			"	<!--from:10.78.81.162:16462 to:10.78.130.53:40514 party=ms5971:mConn_208439_10.78.130.100_1515684570218-->\r\n" + 
			"	<msml version=\"1.1\">\r\n" + 
			"	<dialogstart target=\"conn:10.78.130.535069+1+26c40002+21d63b9f\" type=\"application/moml+xml\" mark=\"71\">\r\n" + 
			"	<dtmf cleardb=\"false\" iterate=\"forever\">\r\n" + 
			"	<pattern digits=\"length=1\" format=\"moml+digits\">\r\n" + 
			"	<send event=\"app.DtmfDigitReceived\" target=\"source\" namelist=\"dtmf.digits\"/>\r\n" + 
			"	</pattern>\r\n" + 
			"	</dtmf>\r\n" + 
			"	<exit namelist=\"dtmf.end\"/>\r\n" + 
			"	</dialogstart>\r\n" + 
			"	<configureconnection id=\"conn:10.78.130.535069+1+26c40002+21d63b9f\">\r\n" + 
			"	<pps media=\"audio\" namelist=\"packet.*\" enabled=\"true\"/>\r\n" + 
			"	</configureconnection>\r\n" + 
			"	<join id1=\"conf:tribMix1497x3ms1c7b1495t1515684510894\" id2=\"conn:10.78.130.535069+1+26c40002+21d63b9f\" mark=\"42\">\r\n" + 
			"	<stream media=\"audio\" dir=\"from-id1\">\r\n" + 
			"	<tpc call-type=\"NH\" ptt-state=\"null\" use-rtp-ext=\"enabled\"/>\r\n" + 
			"	</stream>\r\n" + 
			"	<stream media=\"audio\" dir=\"to-id1\">\r\n" + 
			"	<tpc call-type=\"NH\" ptt-state=\"null\" use-rtp-ext=\"enabled\"/>\r\n" + 
			"	</stream>\r\n" + 
			"	</join>\r\n" + 
			"	</msml>\r\n" + 
			"	conn:10.78.130.535069+1+26c40002+21d63b9f\" mark=\"42\">\r\n" + 
			"	<stream media=\"audio\" dir=\"from-id1\">\r\n" + 
			"	<tpc call-type=\"NH\" ptt-state=\"null\" use-rtp-ext=\"enabled\"/>\r\n" + 
			"	</stream>\r\n" + 
			"	<stream media=\"audio\" dir=\"to-id1\">\r\n" + 
			"	<tpc call-type=\"NH\" ptt-state=\"null\" use-rtp-ext=\"enabled\"/>\r\n" + 
			"	</stream>\r\n" + 
			"	</join>\r\n" + 
			"	</msml>\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.300553-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 964: (tos 0x68, ttl 64, id 12962, offset 0, flags [0x4000], proto TCP (6), length 948)  10.78.130.53:5070 > 10.78.130.51:47841: Flags:[0x18], chsum 0x5ff3, seq 2757442555:2757443451, ack 3308237293, win 327, urp 0 length 896 \r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 2 INFO\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;received=10.78.130.51;branch=z9hG4bK577e70175bc10246b47289d55455f9e1\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK577e70175bc10246b47289d55455f9e1;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Accept: application/sdp, text/*, application/msml+xml, application/moml+xml\r\n" + 
			"	Content-Length: 188\r\n" + 
			"	Content-Type: application/msml+xml\r\n" + 
			"	Contact: <sip:msml@10.78.130.53:5069;transport=TCP>\r\n" + 
			"	\r\n" + 
			"	<?xml version=\"1.0\" encoding=\"US-ASCII\"?>\r\n" + 
			"	<msml version=\"1.1\">\r\n" + 
			"	<result response=\"200\">\r\n" + 
			"	<dialogid>conn:10.78.130.535069+1+26c40002+21d63b9f/dialog:msml.1</dialogid>\r\n" + 
			"	</result>\r\n" + 
			"	</msml>\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.300553-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 964: (tos 0x68, ttl 64, id 12962, offset 0, flags [0x4000], proto TCP (6), length 948)  10.78.130.53:5070 > 10.78.130.51:47841: Flags:[0x18], chsum 0x5ff3, seq 2757442555:2757443451, ack 3308237293, win 327, urp 0 length 896 \r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 2 INFO\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/TCP 10.78.130.100:5060;received=10.78.130.51;branch=z9hG4bK577e70175bc10246b47289d55455f9e1\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK577e70175bc10246b47289d55455f9e1;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Accept: application/sdp, text/*, application/msml+xml, application/moml+xml\r\n" + 
			"	Content-Length: 188\r\n" + 
			"	Content-Type: application/msml+xml\r\n" + 
			"	Contact: <sip:msml@10.78.130.53:5069;transport=TCP>\r\n" + 
			"	\r\n" + 
			"	<?xml version=\"1.0\" encoding=\"US-ASCII\"?>\r\n" + 
			"	<msml version=\"1.1\">\r\n" + 
			"	<result response=\"200\">\r\n" + 
			"	<dialogid>conn:10.78.130.535069+1+26c40002+21d63b9f/dialog:msml.1</dialogid>\r\n" + 
			"	</result>\r\n" + 
			"	</msml>\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.300635-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 834: (tos 0x68, ttl 64, id 0, offset 0, flags [0x4000], proto UDP (17), length 818)  10.78.130.100:5060 > 10.78.130.100:5059,  length 790\r\n" + 
			"	SIP/2.0 200 OK\r\n" + 
			"	Call-ID: wlss-2d81f470-4b73914c365d578fd7afa7874457d07e@10.78.130.51\r\n" + 
			"	CSeq: 2 INFO\r\n" + 
			"	From: <sip:psoundararajan@ipc.com>;tag=39ec8b6c\r\n" + 
			"	To: <sip:7334@10.78.130.53>;tag=10.78.130.535069+1+26c40002+21d63b9f\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.130.100:5059;wlsscid=6aa6b97cdedafbd6;branch=z9hG4bK577e70175bc10246b47289d55455f9e1;wlsssid=sip-doj1h155bv0n\r\n" + 
			"	Server: DC-SIP/2.0\r\n" + 
			"	Supported: precondition, 100rel, timer\r\n" + 
			"	Accept: application/sdp, text/*, application/msml+xml, application/moml+xml\r\n" + 
			"	Content-Length: 188\r\n" + 
			"	Content-Type: application/msml+xml\r\n" + 
			"	Contact: <sip:msml@10.78.130.53:5069;transport=TCP>\r\n" + 
			"	\r\n" + 
			"	<?xml version=\"1.0\" encoding=\"US-ASCII\"?>\r\n" + 
			"	<msml version=\"1.1\">\r\n" + 
			"	<result response=\"200\">\r\n" + 
			"	<dialogid>conn:10.78.130.535069+1+26c40002+21d63b9f/dialog:msml.1</dialogid>\r\n" + 
			"	</result>\r\n" + 
			"	</msml>\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.301849-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 649: (tos 0x68, ttl 59, id 0, offset 0, flags [0x4000], proto UDP (17), length 633)  10.78.81.162:5060 > 10.78.130.100:5060,  length 605\r\n" + 
			"	ACK sip:app-rrs4jz624xn9@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-rrs4jz624xn9 SIP/2.0\r\n" + 
			"	From: \"Prabu Soundararajan\"<sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>;tag=4a992754\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	CSeq: 1 ACK\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f80c-36431b22-38c23930\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Route: <sip:10.78.130.100;lr>\r\n" + 
			"	Contact: <sip:psoundararajan@10.78.81.162:5060>\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"\r\n" + 
			"2018-01-11 10:29:30.301849-05:00   00:00:00:00:00:00 > 00:00:00:00:00:00, ethertype IPv4 (0x800), length 649: (tos 0x68, ttl 59, id 0, offset 0, flags [0x4000], proto UDP (17), length 633)  10.78.81.162:5060 > 10.78.130.100:5060,  length 605\r\n" + 
			"	ACK sip:app-rrs4jz624xn9@10.78.130.100:5059;transport=udp;wlsscid=6aa6b97cdedafbd6;sipappsessionid=app-rrs4jz624xn9 SIP/2.0\r\n" + 
			"	From: \"Prabu Soundararajan\"<sip:7334@10.78.130.100:5060>;tag=38d1fb30-0-13c4-65014-279b62-2e44bd44-279b62\r\n" + 
			"	To: <sip:7334@10.78.130.100:5060>;tag=4a992754\r\n" + 
			"	Call-ID: 105b3f08-0-13c4-65014-279b62-5f772146-279b62\r\n" + 
			"	CSeq: 1 ACK\r\n" + 
			"	Via: SIP/2.0/UDP 10.78.81.162:5060;branch=z9hG4bK-279b62-9ab6f80c-36431b22-38c23930\r\n" + 
			"	Max-Forwards: 70\r\n" + 
			"	User-Agent: IPC SIP Turret IQMAX - 03.01.00.03.0025\r\n" + 
			"	Route: <sip:10.78.130.100;lr>\r\n" + 
			"	Contact: <sip:psoundararajan@10.78.81.162:5060>\r\n" + 
			"	Content-Length: 0\r\n" + 
			"	\r\n" + 
			"	\r\n" + 
			"";
    List<SipCall> sipCallList;
    private static final Lock callListLock = new ReentrantLock(true);
    Table<String> table;    
    WindowBasedTextGUI textGUI;
    BasicWindow windowA;
    
    public SIPflow() {
        sipCallList = new ArrayList<SipCall>();
    }
	public static void main(String[] args) {		
            SIPflow SIPflowObj = new SIPflow();
            String inputData = SIPflowObj.testInputData;
            StringReader SR = new StringReader(inputData);
            new ReaderThread(SIPflowObj ,SR);
            new GuiThread(SIPflowObj);	
	}
	
	synchronized void Gui() throws InterruptedException{
            /*try {
                Terminal term = new DefaultTerminalFactory().createTerminal();
                //Screen screen = new DefaultTerminalFactory().createScreen();
                Screen screen = new TerminalScreen(term);
                textGUI = new MultiWindowTextGUI(screen);
                screen.startScreen();                
                windowA = new BasicWindow("window - A");            
                Panel panelA = new Panel();
                //Panel panelB = new Panel(); 
                windowA.setComponent(panelA);
                table = new Table<String>("Start Time", "End Time", "From","To");
                panelA.addComponent(table);
                
                table.getTableModel().addRow("abc","def","hij","klm");
                //callListLock.lock();
               
                //int i = sipCallList.size() -1;
                //for (int i=0;i < sipCallList.size(); i++) {
                    //System.out.println(sipCallList.get(i).toString());
                while (sipCallList.size()<1){}
                table.getTableModel().addRow(sipCallList.get(0).getStartTime().toString(),sipCallList.get(0).getEndTime().toString(),sipCallList.get(0).getFromAorUser(),sipCallList.get(0).getToAorUser());
                //} 
               // callListLock.unlock();
                
                textGUI.addWindowAndWait(windowA);
                /*while(true){
                    textGUI.wait();
                    callListLock.lock();
                    for (int i=0;i < sipCallList.size(); i++) {
                        //System.out.println(sipCallList.get(i).toString());
                        table.getTableModel().addRow(sipCallList.get(i).getStartTime().toString(),sipCallList.get(i).getEndTime().toString(),sipCallList.get(i).getFromAorUser(),sipCallList.get(i).getToAorUser());
                    } 
                    callListLock.unlock();
                    textGUI.addWindow(windowA);              
                }
            
            } catch (IOException ex) {
                Logger.getLogger(SIPflow.class.getName()).log(Level.SEVERE, null, ex);
            }*/
            while(true){
                wait();
                callListLock.lock();
                for (int i=0;i < sipCallList.size(); i++) {
                    System.out.println(sipCallList.get(i).toString());
                    //table.getTableModel().addRow(sipCallList.get(i).getStartTime().toString(),sipCallList.get(i).getEndTime().toString(),sipCallList.get(i).getFromAorUser(),sipCallList.get(i).getToAorUser());
                } 
                callListLock.unlock();
            }
        }

	void ReadSipMessages(Reader inputReader) throws InterruptedException {
		
                SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd' 'HH:mm:ss.SSSXXX");
		String outMessage = "";		
		String outSrcIp = "";
		String outSrcPort = "";
		String outDstIp = "";
		String outDstPort = "";
		String lineRead = "";
		Pattern beginMsgPattern = Pattern.compile("^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}.\\d{6}.*\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}.*\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}");
		Pattern datePattern = Pattern.compile("(?<date>\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}.\\d{3})(\\d{3})(?<tz>(-|\\+)\\d{2}:\\d{2})");
		Pattern srcIPPattern = Pattern.compile("(?<address>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(.|:)(?<port>\\d*)(?= >)");
		Pattern dstIpPattern = Pattern.compile("(?<=> )(?<address>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(.|:)(?<port>\\d*)");
		BufferedReader inputBuffered = new BufferedReader(inputReader);
		Matcher beginMsgMatcher = beginMsgPattern.matcher(lineRead);
		Matcher dateMatcher = datePattern.matcher(lineRead);
		Matcher srcIpMatcher = srcIPPattern.matcher(lineRead);
		Matcher dstIpMatcher = dstIpPattern.matcher(lineRead);
		boolean foundNextMsg = false;
		
		try {
                    Date outTimeDateStamp = dateFormat.parse("2000-01-01 00:00:00.000-00:00");
                    //loop trough all data
                    while (foundNextMsg||((lineRead=inputBuffered.readLine()) != null))
                    {
                        foundNextMsg = false;
                        //match on begining of message pattern
                        beginMsgMatcher.reset(lineRead);
                        if (beginMsgMatcher.find(0)) {
                            //add line to outMessage
                            outMessage += lineRead + "\r\n";   
                            //find time date stamp
                            dateMatcher.reset(lineRead);
                            if (dateMatcher.find()) {
                                    outTimeDateStamp=dateFormat.parse(dateMatcher.group("date")+dateMatcher.group("tz"));
                            }
                            //find source ip and port
                            srcIpMatcher.reset(lineRead);
                            if(srcIpMatcher.find() ){					
                                    outSrcIp = srcIpMatcher.group("address");
                                    outSrcPort = srcIpMatcher.group("port");
                            }
                            //find destination ip and port
                            dstIpMatcher.reset(lineRead);
                            if(dstIpMatcher.find()){
                                    outDstIp = dstIpMatcher.group("address");
                                    outDstPort = dstIpMatcher.group("port");
                            }	
                        }
                        //loop and read from data
                        while ((lineRead=inputBuffered.readLine()) != null) {
                            //match if begining of line next message 
                            beginMsgMatcher.reset(lineRead);
                            if (beginMsgMatcher.find()) {				
                                    //get the last SipMessage in SIPmesagesList and parse it to SipCalls  
                                    ParseSipCalls(new SipMessage(outMessage,
                                                    outTimeDateStamp,
                                                    outSrcIp,
                                                    outSrcPort,
                                                    outDstIp,
                                                    outDstPort));
                                    
                                    //clear the variables after they have been added to a sipMessage
                                    outMessage = "";						
                                    outSrcIp = "";
                                    outSrcPort = "";
                                    outDstIp = "";
                                    outDstPort = "";					
                                        
                                    //add the begining line of the next message to the outMessage
                                    //outMessage += lineRead + "\r\n";
                                    //set foundNextMsg to prevent while reading the next line
                                    foundNextMsg = true;
                                    break;
                            }
                            outMessage += lineRead + "\r\n";
                        }
                    }
		} catch (IOException | ParseException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
        
        synchronized private void ParseSipCalls(SipMessage inputSipMessage) throws IOException, InterruptedException {
            boolean callIdWasFound = false;		
            callListLock.lock();
            for(int i=0;i <sipCallList.size();i++) {			
                if(inputSipMessage.getCallID().matches(sipCallList.get(i).getCallId())) {
                    callIdWasFound = true;
                    sipCallList.get(i).addSipMessage(inputSipMessage);                                
                    break;
                }
            }
            callListLock.unlock();
            if (!callIdWasFound ) {
                //TimeUnit.SECONDS.sleep(10);
                callListLock.lock();
                sipCallList.add(new SipCall(inputSipMessage.getCallID(),inputSipMessage));                
                callListLock.unlock();                   
                notify();
            }
	}

    private static class SipCall {

        private String callId;
	private Date startTime;
	private Date endTime;
	private String toAorUser;
	private String toName;
	private String fromAorUser;
	private String fromName;
	private String uacIp;
	private String uacPort;
	private String uasIp;
	private String uasPort;
	private String method;
	private String uacSdpIp;
	private String uacSdpPort;
	private String uacSdpCodec;
	private String uasSdpIp;
	private String uasSdpPort;
	private String uasSdpCodec;
	private String lastCseq;
	List<SipMessage> sipMessages;
	
	SipCall(String inputCallId,SipMessage inputSipMessage){
		sipMessages = new ArrayList();
		callId = inputCallId;
		toAorUser = "";
		toName = "";
		fromAorUser = "";
		fromName = "";
		uacIp = "";
		uacPort = "";
		uasIp = "";
		uasPort = "";
		method = "";
		uacSdpIp = "";
		uacSdpPort = "";
		uacSdpCodec = "";
		uasSdpIp = "";
		uasSdpPort = "";
		uasSdpCodec = "";
		lastCseq = "";
		addSipMessage(inputSipMessage);
	}
	
	void addSipMessage(SipMessage inputSipMessage){
		sipMessages.add(inputSipMessage);
		if ((startTime==null)||(inputSipMessage.getTimeDateStamp().compareTo(startTime) < 0)) startTime = inputSipMessage.getTimeDateStamp();
		if ((endTime==null)||(inputSipMessage.getTimeDateStamp().compareTo(endTime) > 0)) endTime = inputSipMessage.getTimeDateStamp();
		if (toAorUser == "") toAorUser = inputSipMessage.getToAorUser();
		if (toName == "") toName = inputSipMessage.getToName();
		if (fromAorUser == "") fromAorUser = inputSipMessage.getFromAorUser();
		if (fromName == "") fromName = inputSipMessage.getFromName();
		if (uacIp == "") {
			uacIp = inputSipMessage.getSrcIp();
			uacPort = inputSipMessage.getSrcPort();
		}		
		if (!inputSipMessage.getDstIp().equals(uacIp) ) {
			uasIp = inputSipMessage.getDstIp();
			uasPort = inputSipMessage.getDstPort();
		}
		if (method == "") method = inputSipMessage.getMethod();
		if (
			(inputSipMessage.isHasSdp())&&
			(inputSipMessage.getSrcIp() == uacIp)&&
			(inputSipMessage.getSrcPort() == uacPort)
			) {
				uacSdpIp = inputSipMessage.getSdpIp();
				uacSdpPort = inputSipMessage.getSdpPort();
				uacSdpCodec = inputSipMessage.getSdpCodec();
		}
		if (
			(inputSipMessage.isHasSdp())&&
			(inputSipMessage.getSrcIp() == uasIp)&&
			(inputSipMessage.getSrcPort() == uasPort)
			) {
				uasSdpIp = inputSipMessage.getSdpIp();
				uasSdpPort = inputSipMessage.getSdpPort();
				uasSdpCodec = inputSipMessage.getSdpCodec();
		}
		lastCseq = inputSipMessage.getcSeq(); 
	}

	public String getCallId() {
		return callId;
	}

	public Date getStartTime() {
		return startTime;
	}

	public Date getEndTime() {
		return endTime;
	}

	public String getToAorUser() {
		return toAorUser;
	}

	public String getToName() {
		return toName;
	}

	public String getFromAorUser() {
		return fromAorUser;
	}

	public String getFromName() {
		return fromName;
	}

	public String getUacIp() {
		return uacIp;
	}

	public String getUacPort() {
		return uacPort;
	}

	public String getUasIp() {
		return uasIp;
	}

	public String getUasPort() {
		return uasPort;
	}

	public String getMethod() {
		return method;
	}

	public String getUacSdpIp() {
		return uacSdpIp;
	}

	public String getUacSdpPort() {
		return uacSdpPort;
	}

	public String getUacSdpCodec() {
		return uacSdpCodec;
	}

	public String getUasSdpIp() {
		return uasSdpIp;
	}

	public String getUasSdpPort() {
		return uasSdpPort;
	}

	public String getUasSdpCodec() {
		return uasSdpCodec;
	}

	public String getLastCseq() {
		return lastCseq;
	}

	public List<SipMessage> getSipMessages() {
		return sipMessages;
	}

        @Override
        public String toString() {
            return "SipCall{" + "callId=" + callId + ", startTime=" + startTime + ", endTime=" + endTime + ", toAorUser=" + toAorUser + ", toName=" + toName + ", fromAorUser=" + fromAorUser + ", fromName=" + fromName + ", uacIp=" + uacIp + ", uacPort=" + uacPort + ", uasIp=" + uasIp + ", uasPort=" + uasPort + ", method=" + method + ", uacSdpIp=" + uacSdpIp + ", uacSdpPort=" + uacSdpPort + ", uacSdpCodec=" + uacSdpCodec + ", uasSdpIp=" + uasSdpIp + ", uasSdpPort=" + uasSdpPort + ", uasSdpCodec=" + uasSdpCodec + ", lastCseq=" + lastCseq + '}';
        }

    }

    private static class SipMessage {

        private Date timeDateStamp;	
	private String srcIp;
	private String srcPort;
	private String dstIp;
	private String dstPort;
	private String req;
	private String method;
	private String response;
	private String callID;
	private String toName;
	private String toAorUser;
	private String fromName;
	private String fromAorUser;
	private String color;
	private boolean hasSdp;
	private String sdpIp;
	private String sdpPort;
	private String sdpCodec;
	private String ua;
	private String cSeq;
	private String message;

	SipMessage(
			String inputMessage,
			Date inputTimeDateStamp,
			String inputSrcIp,
			String inputSrcPort,
			String inputDstIp,
			String inputDstPort
			){
		message = inputMessage;
		timeDateStamp = inputTimeDateStamp;
		srcIp = inputSrcIp;
		srcPort = inputSrcPort;
		dstIp = inputDstIp;
		dstPort = inputDstPort;
		
		Pattern reqPattern = Pattern.compile("((?<method>(ACK|BYE|CANCEL|INFO|INVITE|MESSGAGE|NOTIFY|OPTIONS|PRACK|PUBLISH|REFER|REGISTER|SUBSCRIBE|UPDATE))\\s+(?<uri>.*)\\s+(SIP\\/2.0)$)|SIP\\/2.0 (?<response>\\d{3}.*)",Pattern.MULTILINE);
		Pattern callIDPattern = Pattern.compile("(?<!-.{8})(?<=Call-ID:)\\s*(?<callid>\\S*)",Pattern.MULTILINE);
		Pattern toPattern = Pattern.compile("(?<=To:)\\s*(?<name>\\x22.+\\x22)?\\d*<?(sip:)(?<aorUser>[^@>]+)",Pattern.MULTILINE);
		Pattern fromPattern = Pattern.compile("(?<=From:)\\s*(?<name>\\x22.+\\x22)?\\d*<?(sip:)(?<aorUser>[^@>]+)",Pattern.MULTILINE);
		Pattern hasSdpPattern = Pattern.compile("Content-Type: application\\/sdp",Pattern.MULTILINE);
		Pattern sdpIpPattern = Pattern.compile("(?<=c=IN IP4 )\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",Pattern.MULTILINE);
		Pattern sdpPortPattern = Pattern.compile("(?<=m=audio )\\d*",Pattern.MULTILINE);
		Pattern sdpCodecPattern = Pattern.compile("(?<=RTP\\/AVP )\\d*",Pattern.MULTILINE);
		Pattern uaPattern = Pattern.compile("(?<=User-Agent:)\\s*(?<ua>.*)",Pattern.MULTILINE);
		Pattern serverPattern = Pattern.compile("(?<=Server:)\\s*(?<server>.*)",Pattern.MULTILINE);
		Pattern cSeqPattern = Pattern.compile("CSeq:\\s?(\\d{1,3})\\s?(\\w*)",Pattern.MULTILINE);		
		
		Matcher reqMatcher = reqPattern.matcher(message);
		Matcher callIDMatcher = callIDPattern.matcher(message);
		Matcher toMatcher = toPattern.matcher(message);
		Matcher fromMatcher = fromPattern.matcher(message);
		Matcher hasSdpMatcher = hasSdpPattern.matcher(message);
		Matcher sdpIpMatcher = sdpIpPattern.matcher(message);
		Matcher sdpPortMatcher = sdpPortPattern.matcher(message);
		Matcher sdpCodecMatcher = sdpCodecPattern.matcher(message);
		Matcher uaMatcher = uaPattern.matcher(message);
		Matcher severMatcher = serverPattern.matcher(message);
		Matcher cSeqMatcher = cSeqPattern.matcher(message);		
		
		if(reqMatcher.find()) {
			method = reqMatcher.group("method");
			response = reqMatcher.group("response");
			req = method+reqMatcher.group("uri")+response;			
		}
		if(callIDMatcher.find()) {
			callID = callIDMatcher.group("callid");
		}
		if(toMatcher.find()) {
			toName = toMatcher.group("name");
			toAorUser = toMatcher.group("aorUser");
		}
		if(fromMatcher.find()) {
			fromName = fromMatcher.group("name");
			fromAorUser = fromMatcher.group("aorUser");
		}
		if(hasSdpMatcher.find()) {
			hasSdp = true;
			if(sdpIpMatcher.find()) {
				sdpIp = sdpIpMatcher.group(0);
			}
			if(sdpPortMatcher.find()) {
				sdpPort = sdpPortMatcher.group(0);
			}
			if(sdpCodecMatcher.find()) {
				sdpCodec = sdpCodecMatcher.group(0);
			}
		}
		if(uaMatcher.find()) {
			ua = uaMatcher.group("ua");						
		}
		else{
			if(severMatcher.find()) {
				ua = severMatcher.group("server");
			}
		}
		if(cSeqMatcher.find()) {
			cSeq = cSeqMatcher.group(0);
		}
	}

	public Date getTimeDateStamp() {
		return timeDateStamp;
	}
	
	public String getSrcIp() {
		return srcIp;
	}
	
	public String getSrcPort() {
		return srcPort;
	}
	
	public String getDstIp() {
		return dstIp;
	}
	
	public String getDstPort() {
		return dstPort;
	}
	
	public String getColor() {
		return color;
	}

	public void setColor(String color) {
		this.color = color;
	}

	public String getReq() {
		return req;
	}

	public String getMethod() {
		return method;
	}

	public String getResponse() {
		return response;
	}

	public String getCallID() {
		return callID;
	}

	public String getToName() {
		return toName;
	}

	public String getToAorUser() {
		return toAorUser;
	}

	public String getFromName() {
		return fromName;
	}

	public String getFromAorUser() {
		return fromAorUser;
	}

	public boolean isHasSdp() {
		return hasSdp;
	}

	public String getSdpIp() {
		return sdpIp;
	}

	public String getSdpPort() {
		return sdpPort;
	}

	public String getSdpCodec() {
		return sdpCodec;
	}

	public String getUa() {
		return ua;
	}

	public String getcSeq() {
		return cSeq;
	}

	public String getMessage() {
		return message;
	}

	@Override
	public String toString() {
		return "sipMessage [timeDateStamp=" + timeDateStamp + ", srcIp=" + srcIp + ", srcPort=" + srcPort + ", dstIp="
				+ dstIp + ", dstPort=" + dstPort + ", req=" + req + ", method=" + method + ", response=" + response
				+ ", callID=" + callID + ", toName=" + toName + ", toAorUser=" + toAorUser + ", fromName=" + fromName
				+ ", fromAorUser=" + fromAorUser + ", color=" + color + ", hasSdp=" + hasSdp + ", sdpIp=" + sdpIp
				+ ", sdpPort=" + sdpPort + ", sdpCodec=" + sdpCodec + ", ua=" + ua + ", cSeq=" + cSeq + ", message="
				+ message + "]";
	}
    }

    private static class ReaderThread implements Runnable {

        Reader reader;
        SIPflow sipflow;
        public ReaderThread(SIPflow inputSIPflow, Reader inputReader)  {
            reader = inputReader;
            sipflow = inputSIPflow;
            new Thread(this, "ReaderThread").start();
        }

        @Override
        public void run() {
            try {
                sipflow.ReadSipMessages(reader); //To change body of generated methods, choose Tools | Templates.
            } catch (InterruptedException ex) {
                Logger.getLogger(SIPflow.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

    private static class GuiThread implements Runnable{
        SIPflow sipflow;
        public GuiThread(SIPflow inputSIPflow) {
            sipflow = inputSIPflow;
            new Thread(this, "GuiThread").start();
        }
        
        @Override
        public void run() {
            try {
                sipflow.Gui(); //To change body of generated methods, choose Tools | Templates.
            } catch (InterruptedException ex) {
                Logger.getLogger(SIPflow.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }
}



	



